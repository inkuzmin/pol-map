Создание карты
==============

Для создания карты инстанцируйте класс PolMap:

    var polMap = new PolMap({
        svg: {
            text | node | url: Sting | DOMElement | String
        }
        container | $container: DOMElement | jQueryElement
    });

Карта будет создана одним из трех способов:
 1) Из строки.
 Если свойство svg содержит свойство text, которое содержит строку с описанием svg.

 2) Использованием существующей карты.
 Если свойство svg содержит свойство node, которое содержит svg-элемент.

 3) Загрузкой карты.
 Если свойство svg содежрит свойство url, которое содержит относительный или абсолютный адрес svg-файла.

 Если карта создается из строки (1) или загрузкой (3), необходимо свойство container (с узлом DOM, в котором будет
 отображена карта) или $container (с jQuery оберткой вокруг узла DOM).


Примеры корректного создания объекта
------------------------------------

Из строки и с использованием свойства container:

    var polMap = new PolMap({
        svg: {
            text: '<?xml version="1.0" encoding="utf-8"?><svg><text>Hello, world!</text></svg>'
        }
        container: document.getElementById('map_content')
    });

Загрузкой с использованием относительного url и свойства $container:

    var polMap = new PolMap({
        svg: {
            url: 'svg/map.svg'
        }
        $container: $('#map_content')
    });

Использованием существующей карты:

    var polMap = new PolMap({
        svg: {
            node: document.getElementById('map_svg')
        }
    });

Окрашивание регионов
====================
Код:

    map.getReg(76).setColor(1);
    map.getReg(42).setColor(1);
    map.getReg(4).setColor(2);
    map.getReg(8).setColor(3);
    map.getReg(25).setColor(5);
    map.getReg(77).setColor(8);
    map.getReg(82).setColor(1);

Установка непарного пина
========================
Код:

    map.getReg(76).showUPin();
эквивалентен

    map.showUPin(10);
    
Внешний вид пинов настраивается в map.css (класс .upin)

Удаление непарного пина
-----------------------
Код:

    map.hideUPin(10);



Установка и удаление парного пина
=================================
Код:

    map.showPPin(88, 74);
    map.hidePPin(88, 74);
    
Порядок регионов может быть любым и не обязан совпадать. Следующий код допустим и будет выполнен корректно:

    map.showPPin(88, 74);
    map.hidePPin(74, 88);

Внешний вид парных пинов настраивается в map.css (класс .ppin)

Установка метки
===============
Следующий код

    map.showMark(57, 'red_mark');
    map.showMark(75, 'green_mark');
создаст и установит метки с соответствующими css-классами.

Удаление метки
--------------
Код:

    map.hideMark(57);



Установка пина с картинкой
==========================
Чтобы использовать картинку нужно передать аргумент с объектом, описывающим картинку последним параметром
при первом вызове метода showUPin, showPPin или showMark.

По умолчанию картинки выравниваются по нижнему краю, для выравнивания по центру можно использовать
align: true (см. примеры).

Пример 1. Установка непарного пина с картинкой и выравниванием по центру.

    map.showUPin(10, {
        src: 'http://fc00.deviantart.net/fs71/f/2010/108/b/e/Free_Cloud_and_star_icon_by_HeadyMcDodd.gif',
        align: true
    });

Пример 2. Установка парного пина с картинкой и выравниванием по центру.

    map.showPPin(88, 74, {
        src: 'http://fc00.deviantart.net/fs70/f/2010/066/8/a/Earth_Icon_by_HeadyMcDodd.gif',
        align: true
    });

Пример 3. Установка метки с картинкой.

    map.showMark(56, 'red_mark', {
         src: 'http://fc00.deviantart.net/fs70/f/2010/199/0/4/Spinning_Lollipop_Free_Icon_by_HeadyMcDodd.gif'
    });



Фокусировка
===========
Код:

    map.focus(74);
    
Анимированная фокусировка с коэффициентом приближения:
 
    map.focus(15, 1000, 0.8);
    
Показать всю карту
    
    map.focus();
или

    map.focus(0);
    map.focus(0, 1000); // Анимированный переход

Миникарта
=========
Следующий код создаст миникарту

    map.minimap({
      container: document.getElementById('result'), // контейнер, в котором отобразится миникарта
      mainRegNum: 51, // номер основного региона
      otherRegsNums: [50, 47, 53, 52, 39, 2903, 28971], // номера остальных регионов, которые должны попасть в миникарту
      callback: function() {console.log('Success!')}
    });

Режим определения центров
=========================
Код:

    map.centrate()
Служебный метод. После его вызова клик по карте выводит в консоль свои координаты. Эти координаты можно использовать для
ручного определения центров регионов (см. пример в main.js):

    ...
    centers: {
                '1': {
                    y: 15443,
                    x: 2978
                },
                '2': {
                    y: 15372,
                    x: 3008
                }
            }
    ...

События
=======
Определены следующие события.
- Указатель над регионом: map:reg:over
- Указатель покинул регион: map:reg:out
- Клик по региону: map:reg:click

- Указатель над пином: map:pin:over
- Указатель покинул пин: map:pin:out
- Клик по пину: map:pin:click

Кроме того, определено событие map:wheel при изменении масштаба карты.

Подписка на события
-------------------
Пример 1. Подписка на клик по пину и вывод номера региона в консоль.ё

    pubsub.subscribe('map:pin:click', function (type, event) {
        var pin = event.target;
        console.log('REGIONS: ' + pin.regs);
    });

Пример 2. Подписка на клик по региону и вывод его номера в консоль.

    pubsub.subscribe('map:reg:click', function (type, event) {
        var reg = event.target;
        console.log('CLICK ON REG: ' + reg.num);
    });

Пример 3. Подписка на hover региона и вывод его номера в консоль.

    pubsub.subscribe('map:reg:over', function (type, event) {
        var reg = event.target;
        console.log('HOVER ON REG: ' + reg.num);
    });


Установка
=========
Следующие файлы входят в дистрибутив:

    utils.js pubsub.js init.js upin.js ppin.js mark.js reg.js map.js (порядок подключения важен)
    map.css
Они должны быть подключены для корректной работы скрипта.

Остальные файлы используются в качестве иллюстративного материала для создания контекста исполнения скрипта.

Глобальные переменные
---------------------
Скрипт создает три глобальных переменных: PM, _ и pubsub.

Сжатие
------
Скрипты могут быть сжаты в один файл с помощью uglifyjs (см. script.min.js).

Зависимости
-----------
Единственная зависимость - jquery-svgpan.js. Этот плагин должен быть загружен до подключения скрипта.